<div
  id="character-container"
  class="relative rounded-xl p-7 mb-10 bg-[#FAF9D9] border-4 border-orange-500 w-1/5 h-56"
>
  <img
    src="../public/imgs/fox/fox1.png"
    class="frame absolute inset-0 w-full h-full opacity-0 transition-opacity duration-200 ease-in-out"
    alt="Frame 1"
  />
  <img
    src="../public/imgs/fox/fox2.png"
    class="frame absolute inset-0 w-full h-full opacity-0 transition-opacity duration-200 ease-in-out"
    alt="Frame 2"
  />
  <img
    src="../public/imgs/fox/fox3.png"
    class="frame absolute inset-0 w-full h-full opacity-0 transition-opacity duration-200 ease-in-out"
    alt="Frame 3"
  />
  <audio
    id="animation-audio"
    src="../public/audio/animaleseVoice.mp3"
    autoplay></audio>
</div>

<!-- Botón para iniciar la animación -->
<button id="start-animation-btn" class="mt-5 px-4 py-2 bg-blue-500 text-white rounded-lg">
  Iniciar Animación
</button>


<script>

  document.addEventListener("DOMContentLoaded", function () {
    const frames = document.querySelectorAll(".frame");
    let currentIndex = 0;
    const totalFrames = frames.length;
    const frameDuration = 200; // Duración de cada frame (milisegundos)
    const totalAnimationTime = 3000; // Duración total de la animación (3 segundos)
    let animationInterval;

    // Obtener el audio y afirmar que es un HTMLAudioElement
    const audio = document.getElementById(
      "animation-audio"
    ) as HTMLAudioElement | null;

    function animate() {
      // Quitar la clase active de la imagen actual
      frames[currentIndex].classList.remove("opacity-100");
      frames[currentIndex].classList.add("opacity-0");

      // Incrementar el índice
      currentIndex = (currentIndex + 1) % totalFrames;

      // Añadir la clase active a la nueva imagen
      frames[currentIndex].classList.remove("opacity-0");
      frames[currentIndex].classList.add("opacity-100");
    }

    // Iniciar la animación
    function startAnimation() {
      // Verificar si el audio existe
      if (audio) {
        // Reproducir el audio cuando la animación comience
        audio.currentTime = 0; // Reiniciar el audio al inicio
        audio.play(); // Reproducir el audio
      }

      animationInterval = setInterval(animate, frameDuration);

      // Detener la animación después de 3 segundos
      setTimeout(function () {
        clearInterval(animationInterval);

        // Volver a mostrar la primera imagen (frame1)
        frames.forEach((frame) => frame.classList.remove("opacity-100"));
        frames.forEach((frame) => frame.classList.add("opacity-0"));
        frames[0].classList.remove("opacity-0");
        frames[0].classList.add("opacity-100");

        // Detener el audio cuando la animación termine
        if (audio) {
          audio.pause();
        }
      }, totalAnimationTime);
    }
	// Iniciar la animación al hacer clic en el botón
    document.getElementById('start-animation-btn').addEventListener('click', function() {
        startAnimation();
    });

    // Iniciar la animación cuando la página esté cargada
    startAnimation();
  });
</script>
